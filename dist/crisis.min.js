/**
 * @name		crisis.js
 * @uri			https://github.com/mookman288/crisis.js
 * @author		PxO Ink
 * @license		MIT
 * @copyright	2016 PxO Ink. Some Rights Reserved. 
 */
"use strict";var crisis=function(i){if("object"==typeof i)for(var t in i)i.hasOwnProperty(t)&&(this[t]=i[t]);return this.buildRegex(),this.automatic&&this.process(),this};crisis.prototype.automatic=!0,crisis.prototype.inputs=["input[type=text]","textarea"],crisis.prototype.search={suicide:{combinations:[{primary:["kill","hurt","cut"],secondary:["myself","herself","himself"]},{primary:["commit","committing"],secondary:["suicide"]},{primary:["want"],secondary:["to die"]}],strings:[]}},crisis.prototype.helpString={suicide:"Would you like help for you, or someone you know, who is in danger of committing suicide?"},crisis.prototype.redirects={suicide:"http://www.suicide.org/if-you-are-suicidal.html"},crisis.prototype.waitTime=500,crisis.prototype.nodes={},crisis.prototype.regex={},crisis.prototype.buildRegex=function(){for(var i in this.search)if(this.search.hasOwnProperty(i)){if(this.regex[i]=this.regex[i]||[],"object"==typeof this.search[i].combinations)for(var t=0;t<this.search[i].combinations.length;t++)for(var e=0;e<this.search[i].combinations[t].primary.length;e++)for(var s=0;s<this.search[i].combinations[t].secondary.length;s++)this.regex[i].push(new RegExp(this.search[i].combinations[t].primary[e].replace(/\s+/,"\\s+")+"s?\\s+"+this.search[i].combinations[t].secondary[s].replace(/\s+/,"\\s+"),"gi"));if("object"==typeof this.search[i].strings)for(var e=0;e<this.search[i].strings.length;e++)this.regex[i].push(new RegExp(this.search[i].strings[e].replace(/\s+/,"\\s+"),"i"))}},crisis.prototype.detect=function(i){if("undefined"!=typeof this.nodes[i].input)for(var t in this.regex)if(this.regex.hasOwnProperty(t))for(var e=0;e<this.regex[t].length;e++)if(this.nodes[i].input.value.search(this.regex[t][e])){confirm(crisis.helpString[t])&&window.open(crisis.redirects[t],"_blank").focus(),crisis.deactivate(i);break}},crisis.prototype.activate=function(i){if("undefined"!=typeof this.nodes[i]&&this.nodes[i]){var t=this;this.nodes[i]={input:this.nodes[i],uid:i,handler:null},this.nodes[i].input.setAttribute("data-crisis-id",i),this.nodes[i].handler=function(i){t.detect(i)},this.nodes[i].timer=null,this.nodes[i].input.oninput=function(){var i=this.getAttribute("data-crisis-id");return clearTimeout(t.nodes[i].timer),t.nodes[i].timer=setTimeout(function(){t.nodes[i].handler(i)},t.waitTime),!0},this.nodes[i].input.onpropertychange=this.nodes[i].input.oninput}},crisis.prototype.deactivate=function(i){"undefined"!=typeof this.nodes[i]&&this.nodes[i]&&(this.nodes[i].handler=function(){return!0})},crisis.prototype.generate=function(){return Math.floor(1649374544727*Math.random()).toString(16)},crisis.prototype.getNodes=function(){for(var i=0;i<this.inputs.length;i++)return document.querySelectorAll(this.inputs[i])},crisis.prototype.process=function(i){for(var i=this.getNodes(),t=0;t<i.length;t++){var e=this.generate();this.nodes[e]=i[t],this.activate(e)}};